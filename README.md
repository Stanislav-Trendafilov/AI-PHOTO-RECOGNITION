Национална олимпиада по Информационни технологии – 2023/2024г.
Проект за разпознаване на изображения генерирани от изкуствен интелект – AI Photo Recognition

1.	Тема на изработения проект:
Разработване на система за разграничаване на изображения генерирани от изкуствен интелект от реални.
Регистрационен номер на проект: 464

2.	Автори на проекта:
- Станислав Иванов Трендафилов
Имейл: sslav2005@gmail.com
Училище: ППМГ “Акад. Никола Обрешков“ 12д клас

- Кристиан Пламенов Петров
Имейл: k_petrov27@abv.bg
Училище: ППМГ “Акад. Никола Обрешков“ 12д клас

3.	Ръководител
- д-р Александър Димитров Иванов
Имейл: alex.ivanov@bfu.bg
Длъжност: старши учител по информатика и информационни технологии

4.	Тема на изработения проект:

4.1 Цели на проекта:
Проектът има за цел изработката на софтуер, разпознаващ изображенията генерирани от изкуствен интелект.  Ползата от такова приложение е да се предотвратят злоупотреби с фалшиво съдържание, като например неправомерна употреба на нечий образ, разпознаване на фалшиви новини, предотвратяване на персонални атаки и други потенциални злоупотреби. Приложението може да осигури:
Безопасност и сигурност: Идентификацията на изображения, генерирани от ИИ, може да помогне в предотвратяването на злоупотреби със самоличност в социални мрежи, където се разпространяват съдържания, създадени от автоматизирани системи.
Борба с дезинформацията: Разпознаването на изображения, създадени от изкуствен интелект, може да подпомогне усилията за борба с фалшиви новини и дезинформация, които често използват генеративни модели за създаване на манипулативни съдържания.
Потребителска прозрачност: Предоставя информация и прозрачност за това, дали конкретно изображение е резултат на изкуствен интелект или е създадено от човек, което може да влияе на начина, по който потребителите взаимодействат със съдържанието. Приложението може да се използва в изясняването на авторски права върху дигитално съдържание.
Контрол върху технологичното развитие: Разпознаването на изображения, генерирани от ИИ, може да помогне в регулирането и контрола на технологичния напредък и усъвършенстването на алгоритмите за създаване на автоматизирани изображения.
Манипулацията на визуалната информация е голям проблем, пред който е изправено цялото общество. Разграничаването на синтетичните изображения от реалните (създадени от хора) става все по-важно, защото злоупотребите започват да стават все по-чести и шансът да разберем, че дадена снимка е изкуствено генерирана намалява с усъвършенстване на генеративните технологии. В наши дни снимките, генерирани от изкуствен интелект, стават все по-често срещани и присъстват във все повече дигитални платформи. В библиотеките със стокови изображения, достъпни с лиценз, става все по-важно да се определи дали дадено изображение е генерирано от изкуствен интелект, главно защото тяхната правна основа е различна от традиционните, създадени от човека. Когато потребителите използват генеративни технологии с изкуствен интелект, за да манипулират образа на човек от реалния живот резултатът може да бъде реалистичен и правдоподобен. В случаите, в които създателят  не изясни, че това изображение е изкуствено създадено може да възникнат много проблеми. Ако потребителите не внимават може да попаднат на дезинформация и фалшиви събития. Освен това, много хора поставят под въпрос законността на синтетичните медии, тъй като те са технически изградени от „битове“, от работата на други (човешки) художници, често без разрешение или компенсация. Към този момент нито един инструмент за генериране на изкуствени изображения не може да гарантира правната валидност на изображенията, създадени с него и че никоя от страните не притежава авторските права върху споменатите изображения. Докато генерираните от изкуствен интелект снимки са забавни за създаване и визуално въздействащи, някои генератори на изображения с изкуствен произход са по-безопасни и етично по-справедливи от други. Всичко това създава необходимост да се знае кога изображение, което виждаме, е генерирано по изкуствен начин и какви са правата върху това изображение, ако решим да го използваме.
В процеса на проучване не успяхме да открием софтуер, който успява да разпознава снимките създадени от изкуствен интелект и да бъде лицензиран по някакъв начин.

4.2 Основни етапи в реализирането на проекта (основни дейности, роли на авторите)
Основните етапи при изготвяне на настоящият проект са следните:
1)	Проучване на съществуващи решения и релевантни технологии
2)	Логическо проектиране на бъдещата система, избор на технологии и разпределяне на задачи
3)	Снабдяване с необходимите данни за обучение на модела (конволюционна невронна мрежа)
4)	Обучение на модела с данните и тестване на обучението
5)	Изграждане на потребителския интерфейс
6)	Интегриране на потребителския интерфейс с обучения модел
7)	Изготвяне на документация


4.3. Ниво на сложност на проекта − основни проблеми при реализация на поставените цели
Реализирането на проекта изисква познаване на съвременните технологии за машинно обучение (machine learning), намиране и обработка на данни, необходими за обучението, избор на подходящи настройки на обучението на модела, тестове с разнообразно съдържание, изграждане на адаптивен (responsive) и лесен за работа (user-friendly) интерфейс. Това характеризира проекта като средно високо ниво на сложност.

4.4.	Логическо и функционално описание на решението – архитектура, от какви модули е изградено, какви са функциите на всеки модул, какви са взаимодействията помежду им и т.н.

4.4.1	Използван набор от данни за обучението 
 За обучението на модела, разпознаващ изображения на обекти е използван готов набор от данни, съдържащ 120 000 снимки, разделени на 2 класа - такива генерирани от ИИ и такива, които не са. Изображенията са с резолюция 32 на 32 пиксела и са във формат PNG. За обучението са използвани по-малка част от тези снимки в съотношение 7:3 данни за обучение към данни за тест. Линк към данните: https://www.kaggle.com/datasets/birdy654/cifake-real-and-ai-generated-synthetic-images. 
За обучението на  модела, който разпознава лица е използван готов набор от данни, съдържащи 140 000 снимки, разделени в 2 основни класа: създадени от ИИ и такива, които са реални. Изображенията са с резолюция 256 на 256 пиксела и са във формат JPG. За обучението са използвани 120 000 от тези снимки в съотношение 5:1 данни за обучение към данни за тест. Линк към данните:
https://www.kaggle.com/datasets/xhlulu/140k-real-and-fake-faces

4.4.2 Програмиране и обучение на невронния модел:
За създаването на алгоритъма за разпознаване на генерирани снимки е използвана конволюционна невронна мрежа (Convolutional Neural Network, CNN). CNN е основната технология в обработката на изображения и разпознаването на обекти. Ето основните стъпки, които са включени в кода: 
- Дефиниране на архитектурата на модела: Използва се методът keras.Sequential, който изгражда последователност от слоеве в невронната мрежа. В архитектурата са използвани няколко конволюционни слоя (Conv2D) за извличане на характеристики от изображенията, сливащи слоеве (MaxPooling2D) за намаляване на размерността, слоеве на изравняване (Flatten) и напълно свързани слоеве (Dense) за финалната класификация. 


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/29312e77-e984-4a8a-aaed-dd9e12f9fb91)


 
- Компилиране на модела: За компилацията на модела са използвани оптимизатора "adam" и функцията на грешката двоична кросентропия "binary_crossentropy", тъй като моделът се обучава да класифицира изображенията в две категории (генерирани изображения и реални снимки). Освен това, използвана е и метриката точност ("accuracy") за оценка на точността на модела.


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/4299592a-be3c-45b3-953a-3f4b500aeccf)


 
- Зареждане на данните за обучение и валидационни данни: Използвана е функцията keras.preprocessing.image_dataset_from_directory, за зареждане на данните от съответните директории. Това предоставя удобен начин за работа с данните и предварителна обработка като изменение на размера на изображенията. 


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/53981545-07e3-4e1e-8732-7c3934e215c0)


- Обучение на модела: Извършено обучение на модела, като е използвана функцията "fit" в TensorFlow. Прехвърлени са данните за обучение и валидацията, които предварително бяха заредени, с посочен брой на епохите за обучение (10). Моделът бе обучен чрез оптимизация на функцията на грешката и мерки за оценка.


 ![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/f2c2bb12-084b-423a-a4fd-76624398a99b)


- Обучението протича в 10 отделни епохи като с всяка следваща се подобрява точността на обучаващия се модел (accuracy) и се намалят загубите (loss), което предсталява функция на грешката, определяща разликата между предположените стойности (predicted output) на алгоритъма за обучение на модела и реалните целеви стойности (actual target values).


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/fe3c61cc-6497-4fc5-a1a1-67075ef6838e)


4.4.3 Интегриране на обучения модел в уеб
Flask уеб приложението използва модели за дълбоко обучение за класификация на изображения. Има два основни пътя (/upload_human и /upload_object) за качване на човешки и обектни изображения съответно. Приложението класифицира тези изображения с помощта на предварително обучени модели и показва резултатите на съответните HTML страници. Чрез променливата UPLOAD_FOLDER се задава пътя, където се съхраняват качените изображения.


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/c33698f2-d458-4a20-910c-45351b69d027)


- Обработка на изображения от модела за разпознаване на изкуствено генерирани хора: 
Методът Post има за цел да приема качено изображение на човек. Изображението се обработва, като се преоразмерява до (128, 128) и след това се конвертира в NumPy масив. Прави се прогноза с помощта на обучения модел (human_model). Показва резултата на шаблона human_model_page.html.


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/4df67048-3e49-4015-84bd-f4dcf28e52ae)


- Обработка на изображения от модела за разпознаване на изкуствено генерирани обекти: Методът Post приема каченото изображение на обект. Обработва се изображението за object_model. Зарежда изображението и го преоразмерява до (256, 256), конвертирайки го в NumPy масив.. Прави прогнози с помощта на обучения модел (object_model). След обработка показва резултата на шаблона object_model_page.html. 

4.4.4 Изработка на адаптивен и лесен за работа интерфейс
- Начална страница (Home). Състои се от header, който навигира между отделните страници. Основната част, която представлява кратка информация за проекта и нуждата от това да има софтуер, разпознаващ изкуствено генерирани изображения. Разработена е секция с кратки въпроси и отговори на тема изображения, генерирани от ИИ,


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/c990e1a3-c91a-4d72-9d8f-96a65442ebcb)

![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/8ce2587e-45de-4a26-85bb-3993fd87df48)


- Страница за услуги (Services). Съдържа два панела като единият препраща към модела, който разпознава изображенията генерирани от ИИ, а другият препраща към модела, който е обучен да разпознава обектите, създадени от генеративни технологии. Третият панел представя функционалност, която предстои да бъде реализирана.


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/60e96363-67c1-4c7d-a479-34e1367fc151)


- Страница на предимствата, които осигурява нашия софтуер (Why us). 


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/7b0e31d7-20d7-481f-89ae-2544a2e7fe8f)

![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/1ea013d0-3af7-4a6b-9085-572763939df9)


- Страница, която представя отбора, изготвил проекта.


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/e084fe9d-89bb-4609-b6d8-28245f65f8a3)


- Изработеното приложение е с адаптивен интерфейс (responsive).


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/61ffece4-07f8-49ba-82cf-6cc8e39c85f7)

![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/73d123c4-6501-491a-9b92-3a5a824b636a)


4.5. Реализация − обосновка за използвани технологични средства, алгоритми, литература, програмни приложения и др. 
За представителната част са използвани стандартни технологии – HTML 5, CSS 3, JavaScript и Flask за интегриране на моделите в уеб.
За създаване и обучение на модел е използвана Python библиотеката TensorFlow, която предоставя модели за невронни мрежи. Избрана е технологията конволюционна невронна мрежа, която е state-of-the-art решение за компютърно зрение. Използвани са и помощни библиотеки на същия език за обработка и прочит на изображения, както и тестване на машинното обучение.

4.6. Описание на приложението – как се стартира и/или инсталира, как се използва, как се поддържа 
Проектът е реализиран като уеб приложение, разработено чрез Python фреймуърка Flask. 
Зависимости (Dependencies): 
Необходимо е всички Python пакети да са инсталирани. Може да се инсталират с помощта на следната команда: pip install Flask tensorflow keras Pillow
Конфигурация:
Трябва да се зададе променливата UPLOAD_FOLDER на пътя, където се съхраняват качените изображения.
Стартиране на приложението:
За да се стартира Flask приложението, трябва в терминала да се напише следната команда:
python app.py
Това ще стартира уеб сървър, а приложението ще бъде достъпно на http://127.0.0.1:5000/.
Налични са следните страници, които реализират основната функционалност на нашето приложение:
- При отваряне на страницата на модела за разпознаване на синтетично създадени обекти излиза прозорец, който трябва да бъде натиснат за избор на изображение.


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/f687c661-9f73-44ee-bb45-779ba3037c14)


- Избираме изображение на котка, генерирано от ИИ


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/15197f6f-03f0-45e3-af5e-500773abdb67)


- След натискане на бутона за качване (Upload) получаваме отговор за произхода на прикачената снимка. При натискане на бутона за изчистване (Clear) снимката се зачиства и се връщаме в предишното положение (скрийншотът прикачен по-горе). 


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/64f4b0f6-2800-4f72-9325-16a393004e12)


- При избиране на страницата на модела за разпознаване на човешки изображения е налице същата функционалност.


![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/d89d6f6a-4419-42a6-902e-2a63a349f0f2)

![image](https://github.com/Kristian2705/AI-Photo-Recognition/assets/114022982/1d4e50b1-7a63-49f1-8c0b-5c95dfc21570)


4.7. Заключение
Настоящият проект успешно реализира уеб приложение с интегриран обучен невронен модел за разпознаване на съдържание, генерирано от ИИ и реални снимки. Проектът е работещ, като към момента е постигната точност от над 96% при проведени тестове. Предвид непрекъснатото подобряване на генеративните модели, се очаква моделът да бъде периодично дообучаван за съгласуване на качеството на разпознаване с качеството на генеративното съдържание. Също така бъдещата реализация на проекта би включвала множество подобрения като:
•	Увеличаване на разнообразието от данни за обучение – Добавяне на по разнообразни обеми от данни за обучение с цел разширяване на използваемостта в различни сфери. 
•	Подобряваняне на точността на текущите модели - Интегриране на различни модели и алгоритми за по-добра прецизност при разпознаването. Работа върху оптимизацията на алгоритмите за по-бързо и по-ефективно разпознаване.
•	Интегриране на лицево разпознаване – Обуване на нов модел, който цели да разпознава изображенията на точно определени групи от хора.
•	Внедряване на разпознаването на изображения в реално време - Развитие на системата, с което ще може да работи в реално време за незабавно разпознаване на генерирани изображения.
•	Разпознаване на процент от изображението, генерирано от изкуствен интелект – Изследва изображението и проверява каква част от него е изкуствено генерирана.



Използвани източници:

* https://www.fotor.com/features/ai-image-generator/
* https://freeimagegenerator.com/?aiPrompt=forest&currentPage=1&numPerPage=12
* https://stackoverflow.com/
* https://www.tensorflow.org/
* https://github.com/keras-team/keras
* https://deepai.org/machine-learning-model/text2img
* Kirill Vishniakov and Zhiqiang Shen and Zhuang Liu, ConvNet vs Transformer, Supervised vs CLIP: Beyond ImageNet Accuracy, aXiv, 2024





